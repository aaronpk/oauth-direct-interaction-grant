<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 Direct Interaction Grant</title>
<meta content="Aaron Parecki" name="author">
<meta content="Pieter Kasselman" name="author">
<meta content='
       This document extends the OAuth 2.0 Authorization Framework   with a
new grant type, the "Direct Interaction Grant", which can be used by applications
that want to control the user experience of the process of obtaining authorization
from the user. 
       In many cases, this can provide an entirely browserless experience suited for native
applications, delegating to the browser in unexpected or error conditions. 
       While a fully-delegated approach using the Authorization Code Grant is generally
preferred, this draft provides a mechanism for the client to directly interact
with the user. This requires a high degree of trust between the authorization server
and the client. It  SHOULD  only be considered when there are usability
concerns with a browser-based approach, such as for native mobile or desktop applications. 
    ' name="description">
<meta content="xml2rfc 3.15.3" name="generator">
<meta content="oauth" name="keyword">
<meta content="draft-parecki-oauth-direct-interaction-grant-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.15.3
    Python 3.10.8
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.1
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.5
-->
<link href="draft-parecki-oauth-direct-interaction-grant.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl > dt {
  float: left;
  margin-right: 1em;
  min-width: 12ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
dl .break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto) {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OAuth 2.0 Direct Interaction Grant</td>
<td class="right">December 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Parecki &amp; Kasselman</td>
<td class="center">Expires 18 June 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OAuth Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-parecki-oauth-direct-interaction-grant-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-12-15" class="published">15 December 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-06-18">18 June 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Parecki</div>
<div class="org">Okta</div>
</div>
<div class="author">
      <div class="author-name">P. Kasselman</div>
<div class="org">Microsoft</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 Direct Interaction Grant</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document extends the OAuth 2.0 Authorization Framework <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> with a
new grant type, the "Direct Interaction Grant", which can be used by applications
that want to control the user experience of the process of obtaining authorization
from the user.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">In many cases, this can provide an entirely browserless experience suited for native
applications, delegating to the browser in unexpected or error conditions.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">While a fully-delegated approach using the Authorization Code Grant is generally
preferred, this draft provides a mechanism for the client to directly interact
with the user. This requires a high degree of trust between the authorization server
and the client. It <span class="bcp14">SHOULD</span> only be considered when there are usability
concerns with a browser-based approach, such as for native mobile or desktop applications.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://aaronpk.github.io/oauth-direct-interaction-grant/draft-parecki-oauth-direct-interaction-grant.html">https://aaronpk.github.io/oauth-direct-interaction-grant/draft-parecki-oauth-direct-interaction-grant.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-parecki-oauth-direct-interaction-grant/">https://datatracker.ietf.org/doc/draft-parecki-oauth-direct-interaction-grant/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        OAuth Working Group mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://oauth.net">https://oauth.net</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/aaronpk/oauth-direct-interaction-grant">https://github.com/aaronpk/oauth-direct-interaction-grant</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 18 June 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-usage-and-applicability" class="internal xref">Usage and Applicability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.1">
                    <p id="section-toc.1-1.1.2.2.2.1.1" class="keepWithNext"><a href="#section-1.2.1" class="auto internal xref">1.2.1</a>.  <a href="#name-sign-up-with-verification" class="internal xref">Sign-up with verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.2">
                    <p id="section-toc.1-1.1.2.2.2.2.1" class="keepWithNext"><a href="#section-1.2.2" class="auto internal xref">1.2.2</a>.  <a href="#name-register-new-authentication" class="internal xref">Register new authentication methods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.3">
                    <p id="section-toc.1-1.1.2.2.2.3.1"><a href="#section-1.2.3" class="auto internal xref">1.2.3</a>.  <a href="#name-sign-in-with-first-factor" class="internal xref">Sign-in with first factor</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.4">
                    <p id="section-toc.1-1.1.2.2.2.4.1"><a href="#section-1.2.4" class="auto internal xref">1.2.4</a>.  <a href="#name-sign-in-with-additional-fac" class="internal xref">Sign-in with additional factor</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.5">
                    <p id="section-toc.1-1.1.2.2.2.5.1"><a href="#section-1.2.5" class="auto internal xref">1.2.5</a>.  <a href="#name-discover-supported-authenti" class="internal xref">Discover supported authentication methods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.6">
                    <p id="section-toc.1-1.1.2.2.2.6.1"><a href="#section-1.2.6" class="auto internal xref">1.2.6</a>.  <a href="#name-discover-supported-account-" class="internal xref">Discover supported account recover authentication methods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.7">
                    <p id="section-toc.1-1.1.2.2.2.7.1"><a href="#section-1.2.7" class="auto internal xref">1.2.7</a>.  <a href="#name-update-an-existing-authenti" class="internal xref">Update an existing authentication method</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.8">
                    <p id="section-toc.1-1.1.2.2.2.8.1"><a href="#section-1.2.8" class="auto internal xref">1.2.8</a>.  <a href="#name-initiate-browser-based-inte" class="internal xref">Initiate browser-based interaction for certain scenarios</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.9">
                    <p id="section-toc.1-1.1.2.2.2.9.1"><a href="#section-1.2.9" class="auto internal xref">1.2.9</a>.  <a href="#name-discovering-custom-user-att" class="internal xref">Discovering custom user attributes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.10">
                    <p id="section-toc.1-1.1.2.2.2.10.1"><a href="#section-1.2.10" class="auto internal xref">1.2.10</a>. <a href="#name-provide-different-ux-depend" class="internal xref">Provide different UX depending on a user's enrolled authenticators</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-example-flows" class="internal xref">Example Flows</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-password-mfa" class="internal xref">Password + MFA</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-passwordless" class="internal xref">Passwordless</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-re-authenticating-to-an-app" class="internal xref">Re-authenticating to an app a week later</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-authorization-grants" class="internal xref">Authorization Grants</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-one-time-passwords-otp" class="internal xref">One-Time Passwords (OTP)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-out-of-band-authorization-o" class="internal xref">Out-of-Band Authorization (OOB)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-recovery-code" class="internal xref">Recovery Code</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-protocol-endpoints" class="internal xref">Protocol Endpoints</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-authorization-challenge-res" class="internal xref">Authorization Challenge Response</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-authorization-challenge-end" class="internal xref">Authorization Challenge Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-authorization-challenge-req" class="internal xref">Authorization Challenge Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-authorization-challenge-resp" class="internal xref">Authorization Challenge Response</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-otp-challenge" class="internal xref">OTP Challenge</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-oob-challenge" class="internal xref">OOB Challenge</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="auto internal xref">6.2.3</a>.  <a href="#name-recovery-code-challenge" class="internal xref">Recovery Code Challenge</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-user-interaction" class="internal xref">User Interaction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-otp-challenge-interaction" class="internal xref">OTP Challenge Interaction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-oob-challenge-interaction" class="internal xref">OOB Challenge Interaction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="auto internal xref">6.3.3</a>.  <a href="#name-recovery-code-challenge-int" class="internal xref">Recovery Code Challenge Interaction</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-token-request-grant-types" class="internal xref">Token Request Grant Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-otp-grant" class="internal xref">OTP Grant</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-oob-grant" class="internal xref">OOB Grant</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-token-error-response" class="internal xref">Token Error Response</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-recovery-code-grant" class="internal xref">Recovery Code Grant</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-access-token-response" class="internal xref">Access Token Response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-client-receives-trigger-for" class="internal xref">Client receives trigger for authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-client-collects-user-identi" class="internal xref">Client collects user identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-client-initiates-direct-int" class="internal xref">Client initiates direct interaction request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-authorization-server-return" class="internal xref">Authorization Server returns challenge types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-one-time-code" class="internal xref">One-Time code</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="auto internal xref">8.4.2</a>.  <a href="#name-totp" class="internal xref">TOTP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="auto internal xref">8.4.3</a>.  <a href="#name-password" class="internal xref">Password</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.4">
                    <p id="section-toc.1-1.8.2.4.2.4.1"><a href="#section-8.4.4" class="auto internal xref">8.4.4</a>.  <a href="#name-push-notification" class="internal xref">Push notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.5">
                    <p id="section-toc.1-1.8.2.4.2.5.1"><a href="#section-8.4.5" class="auto internal xref">8.4.5</a>.  <a href="#name-redirect" class="internal xref">Redirect</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.6">
                    <p id="section-toc.1-1.8.2.4.2.6.1"><a href="#section-8.4.6" class="auto internal xref">8.4.6</a>.  <a href="#name-combinations" class="internal xref">Combinations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.7">
                    <p id="section-toc.1-1.8.2.4.2.7.1"><a href="#section-8.4.7" class="auto internal xref">8.4.7</a>.  <a href="#name-defining-additional-methods" class="internal xref">Defining additional methods</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-client-requests-an-authenti" class="internal xref">Client requests an authentication challenge</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-client-provides-authenticat" class="internal xref">Client provides authentication details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6.2.1">
                    <p id="section-toc.1-1.8.2.6.2.1.1"><a href="#section-8.6.1" class="auto internal xref">8.6.1</a>.  <a href="#name-token-request" class="internal xref">Token request</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-checking-for-additional-req" class="internal xref">Checking for additional requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-refresh-token-grant" class="internal xref">Refresh Token Grant</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-phishing" class="internal xref">Phishing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-native-client-and-authorisa" class="internal xref">Native client and Authorisation Server trust relationship</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-client-authentication" class="internal xref">Client Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-leaking-information" class="internal xref">Leaking Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-notification-fatigue" class="internal xref">Notification fatigue</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-oauth-parameter-registratio" class="internal xref">OAuth Parameter Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-oauth-uri-registration" class="internal xref">OAuth URI Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-oauth-extensions-error-regi" class="internal xref">OAuth Extensions Error Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-authorization-server-metada" class="internal xref">Authorization Server Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">TODO: Key points to address include problem description, the relationship to the step-up authentication spec (use of acr etc.), properties of the protocol (extensibility etc).<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="usage-and-applicability">
<section id="section-1.1">
        <h3 id="name-usage-and-applicability">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-usage-and-applicability" class="section-name selfRef">Usage and Applicability</a>
        </h3>
<p id="section-1.1-1">TODO: Mention the trust prerequisites for this to be useful. Absolutely not allowed for third-party apps. Designed for native apps, specifically first-party, when the AS and app are operated by the same entity, and the user understands them both as the same entity...<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="section-1.2">
        <h3 id="name-use-cases">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
        </h3>
<p id="section-1.2-1">TODO: We may move these to the appendix, but outlining them in the document will also help guide developers to understand what they can (and cannot) expect to be able to do.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">TODO: Registration flows may need to be a separate document.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<div id="sign-up-with-verification">
<section id="section-1.2.1">
          <h4 id="name-sign-up-with-verification">
<a href="#section-1.2.1" class="section-number selfRef">1.2.1. </a><a href="#name-sign-up-with-verification" class="section-name selfRef">Sign-up with verification</a>
          </h4>
<p id="section-1.2.1-1">e.g. user provides e-mail, is sent a verification code, and then uses the verification code to prove they control the e-mail during sign-up/account creation.<a href="#section-1.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="register-new-authentication-methods">
<section id="section-1.2.2">
          <h4 id="name-register-new-authentication">
<a href="#section-1.2.2" class="section-number selfRef">1.2.2. </a><a href="#name-register-new-authentication" class="section-name selfRef">Register new authentication methods</a>
          </h4>
<p id="section-1.2.2-1">e.g. user selects password, provides phone for SMS codes, etc<a href="#section-1.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sign-in-with-first-factor">
<section id="section-1.2.3">
          <h4 id="name-sign-in-with-first-factor">
<a href="#section-1.2.3" class="section-number selfRef">1.2.3. </a><a href="#name-sign-in-with-first-factor" class="section-name selfRef">Sign-in with first factor</a>
          </h4>
<p id="section-1.2.3-1">e.g. username password<a href="#section-1.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sign-in-with-additional-factor">
<section id="section-1.2.4">
          <h4 id="name-sign-in-with-additional-fac">
<a href="#section-1.2.4" class="section-number selfRef">1.2.4. </a><a href="#name-sign-in-with-additional-fac" class="section-name selfRef">Sign-in with additional factor</a>
          </h4>
<p id="section-1.2.4-1">e.g. user already signed in with one factor (username/password), but now need to "step-up" to second factor (e.g. SMS code).<a href="#section-1.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discover-supported-authentication-methods">
<section id="section-1.2.5">
          <h4 id="name-discover-supported-authenti">
<a href="#section-1.2.5" class="section-number selfRef">1.2.5. </a><a href="#name-discover-supported-authenti" class="section-name selfRef">Discover supported authentication methods</a>
          </h4>
<p id="section-1.2.5-1">e.g. developer can query the authorisation server to determine what authentication methods are supported.<a href="#section-1.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discover-supported-account-recover-authentication-methods">
<section id="section-1.2.6">
          <h4 id="name-discover-supported-account-">
<a href="#section-1.2.6" class="section-number selfRef">1.2.6. </a><a href="#name-discover-supported-account-" class="section-name selfRef">Discover supported account recover authentication methods</a>
          </h4>
<p id="section-1.2.6-1">e.g. developer can query the authorisation server to determine what authentication methods are used for account recovery if one of the methods are lost.<a href="#section-1.2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="update-an-existing-authentication-method">
<section id="section-1.2.7">
          <h4 id="name-update-an-existing-authenti">
<a href="#section-1.2.7" class="section-number selfRef">1.2.7. </a><a href="#name-update-an-existing-authenti" class="section-name selfRef">Update an existing authentication method</a>
          </h4>
<p id="section-1.2.7-1">e.g. the authorisation server may require the user to update a password or provide a new phone number, key or alternative e-mail address if it believes the existing mechanism is no longer trustworthy.<a href="#section-1.2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initiate-browser-based-interaction-for-certain-scenarios">
<section id="section-1.2.8">
          <h4 id="name-initiate-browser-based-inte">
<a href="#section-1.2.8" class="section-number selfRef">1.2.8. </a><a href="#name-initiate-browser-based-inte" class="section-name selfRef">Initiate browser-based interaction for certain scenarios</a>
          </h4>
<p id="section-1.2.8-1">e.g. some scenarios don't benefit from a native implementation and may be more efficiently or securely implemented through the browser (e.g. error scenarios, password recovery, identity verification, social sign-in).<a href="#section-1.2.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discovering-custom-user-attributes">
<section id="section-1.2.9">
          <h4 id="name-discovering-custom-user-att">
<a href="#section-1.2.9" class="section-number selfRef">1.2.9. </a><a href="#name-discovering-custom-user-att" class="section-name selfRef">Discovering custom user attributes</a>
          </h4>
<p id="section-1.2.9-1">e.g. Ability to know mandatory and optional custom attributes configured on the authorisation server (can this be achieve through AS metadata instead of as part of the protocol)?<a href="#section-1.2.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="provide-different-ux-depending-on-a-users-enrolled-authenticators">
<section id="section-1.2.10">
          <h4 id="name-provide-different-ux-depend">
<a href="#section-1.2.10" class="section-number selfRef">1.2.10. </a><a href="#name-provide-different-ux-depend" class="section-name selfRef">Provide different UX depending on a user's enrolled authenticators</a>
          </h4>
<p id="section-1.2.10-1">An AS may support multiple different authenticators, and a user may have set up only one. A client will not know which a user has set up ahead of time. The AS needs to drive the UI in the client login process depending on the configuration of the user account.<a href="#section-1.2.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-2.1">
        <h3 id="name-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.1-1">This specification uses the terms "Access Token", "Authorization Code",
"Authorization Endpoint", "Authorization Server" (AS), "Client", "Client Authentication",
"Client Identifier", "Client Secret", "Grant Type", "Protected Resource",
"Redirection URI", "Refresh Token", "Resource Owner", "Resource Server" (RS)
and "Token Endpoint" defined by <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">TODO: Replace RFC6749 references with OAuth 2.1<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-overview">
<section id="section-3">
      <h2 id="name-protocol-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<ol start="1" type="1" class="normal type-1" id="section-3-1">
<li id="section-3-1.1">The client prompts the user and collects their user identifier (e.g. email address)<a href="#section-3-1.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.2">The client sends the user identifier to the AS, along with any hint it may have received about the authentication level required<a href="#section-3-1.2" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.3">The AS replies with the authentication mechanism required based on the user ID provided (should these be amr values?)<a href="#section-3-1.3" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.4">The client requests an authentication challenge from the AS (this is optional - only if the authentication method requires it)<a href="#section-3-1.4" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.5">The AS delivers a challenge to the user (e.g. one-time code via email, SMS, or a push notification in an app) (this is optional - only if it is a challenge response type authentiation method).<a href="#section-3-1.5" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.6">The client collects the necessary authentication details from the user and sends them back to the AS<a href="#section-3-1.6" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.7">The AS decides if additional requirements need to be met, repeating steps 3 through 6 as needed (the AS knows this due to the acr_value sent by the client initially, or from its own requirements)<a href="#section-3-1.7" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.8">The AS replies with the token response<a href="#section-3-1.8" class="pilcrow">¶</a>
</li>
      </ol>
<div id="example-flows">
<section id="section-3.1">
        <h3 id="name-example-flows">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-example-flows" class="section-name selfRef">Example Flows</a>
        </h3>
<p id="section-3.1-1">TODO: Move these to an appendix<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="password-mfa">
<section id="section-3.1.1">
          <h4 id="name-password-mfa">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-password-mfa" class="section-name selfRef">Password + MFA</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.1.1-1.1">User enters username and password (/initiate login_hint= password=)<a href="#section-3.1.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-1.2">AS responds with <code>mfa_required</code><a href="#section-3.1.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-1.3">Client initiates MFA challenge (authorization challenge endpoint)<a href="#section-3.1.1-1.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-1.4">AS responds with details of MFA challenge<a href="#section-3.1.1-1.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-1.5">Client collects MFA from user (OTP, SMS code, etc)<a href="#section-3.1.1-1.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.1-1.6">Client makes token request (new mfa:otp/mfa:oob grant type)<a href="#section-3.1.1-1.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="passwordless">
<section id="section-3.1.2">
          <h4 id="name-passwordless">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-passwordless" class="section-name selfRef">Passwordless</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.1.2-1.1">Client collects username and OTP from user<a href="#section-3.1.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.2-1.2">Client makes token request (new otp grant type)<a href="#section-3.1.2-1.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="re-authenticating-to-an-app-a-week-later">
<section id="section-3.1.3">
          <h4 id="name-re-authenticating-to-an-app">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-re-authenticating-to-an-app" class="section-name selfRef">Re-authenticating to an app a week later</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-3.1.3-1.1">You log in to an app (in any way, redirect flow or direct)<a href="#section-3.1.3-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-1.2">App gets short lived access token and long lived refresh token<a href="#section-3.1.3-1.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-1.3">A week later, the user launches the app, access token is expired<a href="#section-3.1.3-1.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-1.4">App uses the refresh token, gets back an <code>mfa_required</code> error<a href="#section-3.1.3-1.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-1.5">App prompts and collects MFA from user (OTP or OOB)<a href="#section-3.1.3-1.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.1.3-1.6">App submits token request with grant_type=mfa_otp and mfa_token (which was already associated with the refresh token)<a href="#section-3.1.3-1.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="authorization-grants">
<section id="section-3.2">
        <h3 id="name-authorization-grants">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-authorization-grants" class="section-name selfRef">Authorization Grants</a>
        </h3>
<div id="one-time-passwords-otp">
<section id="section-3.2.1">
          <h4 id="name-one-time-passwords-otp">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-one-time-passwords-otp" class="section-name selfRef">One-Time Passwords (OTP)</a>
          </h4>
<p id="section-3.2.1-1">The one-time password (OTP) credentials can be used as an
authorization grant to obtain an access token.  An OTP is generated
by a hardware device or a software application installed on a device
such as a mobile phone.  These devices have an embedded secret which
used as a seed for generating OTPs.  An OTP is single-use and proves
control of the device.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">When used in addition to another grant type (such as resource owner
password credentials), one-time password credentials add an
additional factor of authentication.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1-3">Even though this grant type requires direct client access to the
resource owner credentials, the resource owner credentials are used
for a single request and are exchanged for an access token.
Furthermore, the single-use nature of an OTP limits the impact of
exposing a long-term password alone to the client when the resulting
access token or refresh token are also short-lived.<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1-4">OTP methods include:<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-5.1">Code generators such as Google Authenticator<a href="#section-3.2.1-5.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="out-of-band-authorization-oob">
<section id="section-3.2.2">
          <h4 id="name-out-of-band-authorization-o">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-out-of-band-authorization-o" class="section-name selfRef">Out-of-Band Authorization (OOB)</a>
          </h4>
<p id="section-3.2.2-1">The out-of-band (OOB) authorization grant allows authorization to be
obtained via a secondary channel.  Once authorized, the grant can be
used to obtain an access token.  Use of a secondary channel supports
several use cases.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">The out-of-band authorization grant can be used with an out-of-band
authenticator to add an additional factor of authentication.  An out-
of-band authenticator is a physical device that is uniquely
addressable and can communicate with the authorization server over a
secondary channel.  Common examples would be a mobile phone using SMS
as a secondary channel, or a software application installed on a
device using push notifications as a secondary channel.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">The out-of-band authorization grant can also facilitate more complex
authorization processes.  For example, out-of-band authorization can
be used to perform multi-party authorization, in which two or more
resource owners are needed in order to grant access.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">OOB methods include:<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-5.1">One-time codes sent via email and SMS<a href="#section-3.2.2-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.2-5.2">Display a code on the primary device, enter it on the secondary device (e.g. OAuth Device Flow)<a href="#section-3.2.2-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.2-5.3">Acknowledge a push notification on a secondary device<a href="#section-3.2.2-5.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.2.2-5.4">Compare the codes displayed on two devices<a href="#section-3.2.2-5.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="recovery-code">
<section id="section-3.2.3">
          <h4 id="name-recovery-code">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-recovery-code" class="section-name selfRef">Recovery Code</a>
          </h4>
<p id="section-3.2.3-1">The recovery code is numeric or character string from a set of
secrets shared between the resource owner and the authorization
server.  These secrets are typically used by the resource owner in
the event another authenticator is lost or malfunctions.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="protocol-endpoints">
<section id="section-4">
      <h2 id="name-protocol-endpoints">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protocol-endpoints" class="section-name selfRef">Protocol Endpoints</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-4-1.1">
          <p id="section-4-1.1.1">Token endpoint<a href="#section-4-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-1.1.2.1">This specification defines new grant types and new error responses<a href="#section-4-1.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-1.1.2.2">Adds <code>device_secret</code> in token response<a href="#section-4-1.1.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-1.1.2.3">Note: Passwords are never sent to the token endpoint<a href="#section-4-1.1.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-4-1.2">
          <p id="section-4-1.2.1">Authorization challenge endpoint<a href="#section-4-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-1.2.2.1">A client requests an authorization challenge (e.g. send a user an SMS code), which it can later use as an authorization grant<a href="#section-4-1.2.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-4-1.3">
          <p id="section-4-1.3.1">Initiate login endpoint<a href="#section-4-1.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-1.3.2.1">A client initiates a login flow<a href="#section-4-1.3.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-1.3.2.2">With or without information collected from the user (e.g. password)<a href="#section-4-1.3.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-1.3.2.3">May contain a <code>device_secret</code><a href="#section-4-1.3.2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4-1.3.2.4">Returns an <code>mfa_token</code><a href="#section-4-1.3.2.4" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-4-2">Not every authorization grant type utilizes both endpoints.
Extension grant types <span class="bcp14">MAY</span> define additional endpoints as needed.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The token endpoint is used by the client to obtain an access token by
presenting its authorization grant or refresh token, as described in
Section 3.2 of OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">This specification adds additional grant types used at the token endpoint, as well as extends the token endpoint response to allow the authorization server to indicate that further authentication of the user is required.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Extension Grant Types<a href="#section-4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-6.1">grant_type=urn:ietf:params:oauth:grant-type:mfa-otp<a href="#section-4-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-6.2">grant_type=urn:ietf:params:oauth:grant-type:mfa-oob<a href="#section-4-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-6.3">grant_type=urn:ietf:params:oauth:grant-type:mfa-recovery-code<a href="#section-4-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-6.4">grant_type=urn:ietf:params:oauth:grant-type:otp<a href="#section-4-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-6.5">grant_type=urn:ietf:params:oauth:grant-type:oob<a href="#section-4-6.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="mfa-token-response">
<section id="section-5">
      <h2 id="name-authorization-challenge-res">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-authorization-challenge-res" class="section-name selfRef">Authorization Challenge Response</a>
      </h2>
<p id="section-5-1">Upon any request to the token endpoint, the authorization server can
respond with an authorization challenge instead of a successful access token response.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">An authorization challenge error response is a particular type of
error response as defined in Section 5.2 of OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> where
the error code is set to the following value:<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3"><code>mfa_required</code><a href="#section-5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-4">
<pre>
  The authorization grant is insufficiently authorized, but another
  access token request MAY succeed if an additional authorization
  grant is presented.
</pre><a href="#section-5-4" class="pilcrow">¶</a>
</div>
<p id="section-5-5">In addition to the response parameters defined in Section 5.2 of
OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the following parameters <span class="bcp14">MUST</span> be included in the
response when the error code is set to <code>mfa_required</code>:<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6"><code>mfa_token</code><a href="#section-5-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-7">
<pre>
  MFA token value associated with the ongoing authorization session.
</pre><a href="#section-5-7" class="pilcrow">¶</a>
</div>
<p id="section-5-8">For example:<a href="#section-5-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-9">
<pre>
HTTP/1.1 403 Forbidden
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store

{
  "error": "mfa_required",
  "mfa_token": "uY29tL2F1dGhlbnRpY"
}
</pre><a href="#section-5-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-challenge-endpoint">
<section id="section-6">
      <h2 id="name-authorization-challenge-end">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-authorization-challenge-end" class="section-name selfRef">Authorization Challenge Endpoint</a>
      </h2>
<p id="section-6-1">The authorization challenge endpoint is used by the client to obtain
an authorization challenge by presenting an MFA token.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Use of the authorization challenge endpoint is <span class="bcp14">OPTIONAL</span>; if a client
knows of a suitable authenticator through an out-of-band mechanism,
it can obtain a strong authorization grant directly.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="authorization-challenge-request">
<section id="section-6.1">
        <h3 id="name-authorization-challenge-req">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-authorization-challenge-req" class="section-name selfRef">Authorization Challenge Request</a>
        </h3>
<p id="section-6.1-1">The client makes a request to the authorization challenge endpoint by
adding the following parameters using the "application/x-www-form-
urlencoded" format with a character encoding of UTF-8 in the HTTP
request body:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
`mfa_token`
    REQUIRED.  The MFA token received from the authorization server in
    the authorization challenge error response.

`challenge_type`
    OPTIONAL.  List of authorization challenge type strings that the
    client supports, expressed as a list of space-delimited, case-
    insensitive strings.

`authenticator_id`
    OPTIONAL.  The identifier of the authenticator to challenge.  The
    authorization server MUST ensure that the authenticator is
    associated with the resource owner.

`client_id`
    REQUIRED, if the client is not authenticating with the
    authorization server as described in Section 3.2.1 of OAuth 2.0
    {{RFC6749}}.
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">For example, the client makes the following HTTP request:<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-4">
<pre>
POST /challenge HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

mfa_token=uY29tL2F1dGhlbnRpY&amp;challenge_type=otp%20oob
</pre><a href="#section-6.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.1-5">The authorization server <span class="bcp14">MUST</span>:<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-6.1">require client authentication for confidential clients or for any
client that was issued client credentials (or with other
authentication requirements),<a href="#section-6.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-6.2">authenticate the client if client authentication is included,<a href="#section-6.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-6.3">ensure that the MFA token was issued to the authenticated
confidential client, or if the client is public, ensure that the
token was issued to the <code>client_id</code> in the request,<a href="#section-6.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-6.4">verify that the MFA token is valid, and<a href="#section-6.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-6.5">restore the authorization session based on the state referenced by
or encoded into the MFA token.<a href="#section-6.1-6.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="authorization-challenge-response">
<section id="section-6.2">
        <h3 id="name-authorization-challenge-resp">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-authorization-challenge-resp" class="section-name selfRef">Authorization Challenge Response</a>
        </h3>
<p id="section-6.2-1">If the authorization challenge request is valid and authorized, the
authorization server selects an authorization challenge, the response
to which would satisfy the authorization session, and constructs the
response by adding the following parameters to the entity-body of the
HTTP response using the <code>application/json</code> format <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span> with a
200 (OK) status code:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>
`challenge_type`

    REQUIRED.  The type of the authorization challenge issued.  Value
    is case insensitive.
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2-3">All additional parameters are specified by the authorization
challenge type. This document defines the <code>otp</code> type, the <code>oob</code> type,
and the <code>recovery-code</code> type.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">For example:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-5">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store

{
  "challenge_type": "otp"
}
</pre><a href="#section-6.2-5" class="pilcrow">¶</a>
</div>
<p id="section-6.2-6">If the authorization challenge request failed, the authorization
server responds with an error response as described in Section 5.2 of
OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">In addition to the error codes defined in Section 5.2 of OAuth 2.0
<span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the following error codes are specified for use in
authorization challenge endpoint responses:<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-8">
<pre>
invalid_authenticator
  The requested authenticator does not exist or is not associated
  with the resource owner.

expired_token
  The provided MFA token is invalid, expired, revoked, or was issued
  to another client.  The client MAY initiate a new authorization
  session.

unsupported_challenge_type
  The challenge types supported by the client are not supported by
  the authorization server or not available to the resource owner.

association_required
  The resource owner is not associated with any authenticator.  The
  authorization session MAY be continued by completing authenticator
  association.

server_error
  The authorization server encountered an unexpected condition that
  prevented it from fulfilling the request.

bad_gateway
  The authorization server received an invalid response from an
  upstream server it accessed in attempting to fulfull the request.
  This typically occurs when challenging an OOB authenticator and
  the gateway is down, for example SMS.
</pre><a href="#section-6.2-8" class="pilcrow">¶</a>
</div>
<div id="otp-challenge">
<section id="section-6.2.1">
          <h4 id="name-otp-challenge">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-otp-challenge" class="section-name selfRef">OTP Challenge</a>
          </h4>
<p id="section-6.2.1-1">If the authorization server requires an OTP credential as an
additional authorization grant, it responds with an OTP authorization
challenge type containing the following parameters:<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-2">
<pre>
`challenge_type`
  REQUIRED.  Value MUST be set to `otp`.
</pre><a href="#section-6.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.1-3">No additional parameters are specified for the OTP authorization
challenge type.<a href="#section-6.2.1-3" class="pilcrow">¶</a></p>
<p id="section-6.2.1-4">For example:<a href="#section-6.2.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.1-5">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store

{
    "challenge_type": "otp"
}
</pre><a href="#section-6.2.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="oob-authorization-challenge">
<section id="section-6.2.2">
          <h4 id="name-oob-challenge">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-oob-challenge" class="section-name selfRef">OOB Challenge</a>
          </h4>
<p id="section-6.2.2-1">If the authorization server requires out-of-band authorization as an
additional authorization grant, it generates a unique out-of-band
transaction code that is valid for a limited time.  It then initiates
an out-of-band authorization operation, the details of which are out
of scope for this specification.  It then responds with an OOB
authorization challenge type containing the following parameters:<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-2">
<pre>
challenge_type
  REQUIRED.  Value MUST be set to "oob".

oob_code
  REQUIRED.  The out-of-band transaction code.  The out-of-band
  transaction code MUST expire shortly after it is issued to
  mitigate the risk of leaks.  A maximum out-of-band transaction
  code lifetime of 10 minutes is RECOMMENDED.
  TODO: Determine whether this is required or what benefit it provides if any.

binding_code
  OPTIONAL.  The end-user verification code used to bind the
  authorization operation on the secondary channel with the primary
  channel.  REQUIRED, if the value of "binding_method" is set to
  "transfer" or "compare".

binding_method
  OPTIONAL.  The method used to bind the authorization operation on
  the secondary channel with the primary channel.  If no value is
  provided, clients MUST use "none" as the default.  Values defined
  by this specification are:

  prompt
     The end user should be prompted to enter a code received during
     out-of-band authorization via the secondary channel into the
     client.  For example, the end user receives a code on their
     mobile phone (typically a 6-digit code) and types it into the
     client.

  transfer
     The client displays or otherwise communicates the
     "binding_code" to the end user and instructs them to enter it
     into or otherwise transfer it to the secondary channel.  For
     example, the end user may view the "binding_code" on the client
     and either type it into an app on their mobile phone or use a
     QR code to effect the transfer.

  compare
     The client displays the "binding_code" to the end user and
     instructs them to compare it to the code received during out-
     of-band authorization before confirming authorization via the
     secondary channel.

  none
     No binding is performed between the client on the primary
     channel and the out-of-band authorization operation via the
     secondary channel.

expires_in
  OPTIONAL.  The lifetime in seconds of the "oob_code".

interval
  OPTIONAL.  The minimum amount of time in seconds that the client
  SHOULD wait between polling requests to the token endpoint.  If no
  value is provided, clients MUST use 5 as the default.
</pre><a href="#section-6.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.2-3">For example:<a href="#section-6.2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.2-4">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store

{
   "challenge_type": "oob",
   "oob_code": "GmRhmhcxhwAzkoEqiMEg_DnyEysNkuNhszIySk9eS",
   "binding_method": "prompt",
   "expires_in": 300,
   "interval": 5
}
</pre><a href="#section-6.2.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="recovery-code-challenge">
<section id="section-6.2.3">
          <h4 id="name-recovery-code-challenge">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-recovery-code-challenge" class="section-name selfRef">Recovery Code Challenge</a>
          </h4>
<p id="section-6.2.3-1">If the authorization server requires a recovery code as an
authorization grant, it responds with a recovery code authorization
challenge containing the following parameters:<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3-2">
<pre>
challenge_type
    REQUIRED.  Value MUST be set to "recovery-code".
</pre><a href="#section-6.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3-3">No additional parameters are specified for the recovery code
authorization challenge type.<a href="#section-6.2.3-3" class="pilcrow">¶</a></p>
<p id="section-6.2.3-4">For example:<a href="#section-6.2.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2.3-5">
<pre>
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
    "challenge_type": "recovery-code"
}
</pre><a href="#section-6.2.3-5" class="pilcrow">¶</a>
</div>
<p id="section-6.2.3-6">TODO: It is unclear why the AS would decide a recovery code is required,
since that assumes the AS knows the user has lost their other MFA options.<a href="#section-6.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="user-interaction">
<section id="section-6.3">
        <h3 id="name-user-interaction">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-user-interaction" class="section-name selfRef">User Interaction</a>
        </h3>
<div id="otp-challenge-interaction">
<section id="section-6.3.1">
          <h4 id="name-otp-challenge-interaction">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-otp-challenge-interaction" class="section-name selfRef">OTP Challenge Interaction</a>
          </h4>
<p id="section-6.3.1-1">After receiving an OTP challenge, the client prompts or otherwise
interacts with the resource owner to obtain an OTP generated by a
device in the possession of the resource owner.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oob-challenge-interaction">
<section id="section-6.3.2">
          <h4 id="name-oob-challenge-interaction">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-oob-challenge-interaction" class="section-name selfRef">OOB Challenge Interaction</a>
          </h4>
<p id="section-6.3.2-1">After receiving an out-of-band challenge, the client prompts or
otherwise interacts with the resource owner to inform them of the
ongoing authorization operation.  Any necessary actions by the
resource owner or other party on the secondary channel are out of
scope of this specification.<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">For example, the client informs the user to expect to receive a
verification code via SMS, and provides a form to enter the code.<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="recovery-code-challenge-interaction">
<section id="section-6.3.3">
          <h4 id="name-recovery-code-challenge-int">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-recovery-code-challenge-int" class="section-name selfRef">Recovery Code Challenge Interaction</a>
          </h4>
<p id="section-6.3.3-1">After receiving a recovery code challenge, the client prompts or
otherwise interacts with the resource owner to obtain a recovery
code.  Such codes are typically already in the resource owner's
posession, having been previously distributed to the resource owner.<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3.3-2">Recovery codes are typically necessary upon the resource owner
realizing that other authenticators have been lost or are
malfunctioning (for instance, when attempting to satisfy a non-
recovery code authorization challenge).  In such an event, the client
<span class="bcp14">SHOULD</span> provide the resource owner a means of directly entering a
recovery flow.<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="token-request-grant-types">
<section id="section-7">
      <h2 id="name-token-request-grant-types">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-token-request-grant-types" class="section-name selfRef">Token Request Grant Types</a>
      </h2>
<p id="section-7-1">This specification defines new grant types at the token endpoint,
providing a way for a client to obtain an access token given any of
the MFA challenges previously described.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="otp-grant">
<section id="section-7.1">
        <h3 id="name-otp-grant">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-otp-grant" class="section-name selfRef">OTP Grant</a>
        </h3>
<p id="section-7.1-1">The client makes a request to the token endpoint by adding the
following parameters using the "application/x-www-form-urlencoded"
format with a character encoding of UTF-8 in the HTTP request body:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-2">
<pre>
grant_type
    REQUIRED. `urn:ietf:params:oauth:grant-type:mfa-otp`

otp
    REQUIRED. The one-time password generated by a device. e.g. 123456

mfa_token
    REQUIRED. The MFA token, "mfa_token" from the prior authorization
    challenge error response

client_id
    REQUIRED if the client is not authenticating with the
    authorization server.
</pre><a href="#section-7.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.1-3">For example:<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-4">
<pre>
POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:mfa-otp
&amp;otp=123456&amp;mfa_token=uY29tL2F1dGhlbnRpY
</pre><a href="#section-7.1-4" class="pilcrow">¶</a>
</div>
<p id="section-7.1-5">The authorization server <span class="bcp14">MUST</span>:<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-6.1">require client authentication for confidential clients or for any
client that was issued client credentials (or with other
authentication requirements),<a href="#section-7.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-6.2">authenticate the client if client authentication is included,<a href="#section-7.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-6.3">ensure that the MFA token was issued to the authenticated
confidential client, or if the client is public, ensure that the
token was issued to "client_id" in the request,<a href="#section-7.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-6.4">verify that the MFA token is valid,<a href="#section-7.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-6.5">restore the authorization session based on the state referenced by
or encoded into the MFA token, and<a href="#section-7.1-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-6.6">validate the one-time password credentials using its existing OTP
validation algorithm.<a href="#section-7.1-6.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oob-grant">
<section id="section-7.2">
        <h3 id="name-oob-grant">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-oob-grant" class="section-name selfRef">OOB Grant</a>
        </h3>
<p id="section-7.2-1">The client makes a request to the token endpoint by adding the
following parameters using the "application/x-www-form-urlencoded"
format with a character encoding of UTF-8 in the HTTP request body:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-2">
<pre>
grant_type
  REQUIRED. `urn:ietf:params:oauth:grant-type:mfa-oob`

oob_code
  REQUIRED.  The out-of-band transaction code, `oob_code` from the
  authorization challenge, defined in {{oob-authorization-challenge}}

binding_code
  REQUIRED, if the binding method of the authorization challenge
  is set to "prompt".

mfa_token
  REQUIRED.  The MFA token, "mfa_token" from the prior authorization
  challenge error response, defined in {{mfa-token-response}}.

client_id
  REQUIRED, if the client is not authenticating with the
  authorization server as described in Section 3.2.1 of OAuth 2.0
  {{RFC6749}}.
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
<p id="section-7.2-3">If the client type is confidential or the client was issued client
credentials (or assigned other authentication requirements), the
client <span class="bcp14">MUST</span> authenticate with the authorization server as described
in Section 3.2.1 of OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">For example, the client makes the following HTTP request using
transport-layer security (with extra line breaks for display purposes only):<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-5">
<pre>
POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:mfa-oob
&amp;oob_code=GmRhmhcxhwAzkoEqiMEg_DnyEysNkuNhszIySk9eS
&amp;binding_code=123456&amp;mfa_token=uY29tL2F1dGhlbnRpY
</pre><a href="#section-7.2-5" class="pilcrow">¶</a>
</div>
<p id="section-7.2-6">The authorization server <span class="bcp14">MUST</span>:<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-7.1">require client authentication for confidential clients or for any
client that was issued client credentials (or with other
authentication requirements),<a href="#section-7.2-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-7.2">authenticate the client if client authentication is included,<a href="#section-7.2-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-7.3">ensure that the MFA token was issued to the authenticated
confidential client, or if the client is public, ensure that the
token was issued to "client_id" in the request,<a href="#section-7.2-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-7.4">verify that the MFA token is valid,<a href="#section-7.2-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-7.5">restore the authorization session based on the state referenced by
or encoded into the MFA token,<a href="#section-7.2-7.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-7.6">validate the out-of-band transaction code using its existing OOB
validation algorithm, and<a href="#section-7.2-7.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-7.7">if required, validate the binding code using its existing OOB
validation algorithm.<a href="#section-7.2-7.7" class="pilcrow">¶</a>
</li>
        </ul>
<div id="token-error-response">
<section id="section-7.2.1">
          <h4 id="name-token-error-response">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-token-error-response" class="section-name selfRef">Token Error Response</a>
          </h4>
<p id="section-7.2.1-1">In addition to the error codes defined in Section 5.2 of OAuth 2.0
<span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the following error codes are specific for the out-of-band
authorization grant in token endpoint responses:<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2.1-2">
<pre>
authorization_pending
  The authorization request is still pending as the out-of-band
  authorization operation has not yet completed.  The client SHOULD
  repeat the access token request to the token endpoint (a process
  known as polling).  Before each new request, the client MUST wait
  at least the number of seconds specified by the "interval"
  parameter of the authorization challenge (see Section 3.2.1), or 5
  seconds if none was provided, and respect any increase in the
  polling interval required by the "slow_down" error.

slow_down
  A variant of "authorization_pending", the authorization request is
  still pending and polling should continue, but the interval MUST
  be increased by 5 seconds for this and all subsequent requests.

access_denied
  The authorization request was denied.

expired_token
  The "oob_code" or "mfa_token" has expired, and the authorization
  session has concluded.  The client MAY commence a new
  authorization session but SHOULD wait for user interaction before
  restarting to avoid unnecessary polling.
</pre><a href="#section-7.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.2.1-3">The <code>authorization_pending</code> and <code>slow_down</code> error codes define
particularly unique behavior, as they indicate that the OAuth client
should continue to poll the token endpoint by repeating the token
request (implementing the precise behavior defined above).  If the
client receives an error response with any other error code, it <span class="bcp14">MUST</span>
stop polling and <span class="bcp14">SHOULD</span> react accordingly, for example, by displaying
an error to the user.<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.2.1-4">On encountering a connection timeout, clients <span class="bcp14">MUST</span> unilaterally
reduce their polling frequency before retrying.  The use of an
exponential backoff algorithm to achieve this, such as doubling the
polling interval on each such connection timeout, is <span class="bcp14">RECOMMENDED</span>.<a href="#section-7.2.1-4" class="pilcrow">¶</a></p>
<p id="section-7.2.1-5">The error codes and client behavior specified in this section are
intentionally identical to those defined by OAuth 2.0 Device
Authorization Grant <span>[<a href="#RFC8628" class="cite xref">RFC8628</a>]</span>.<a href="#section-7.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="recovery-code-grant">
<section id="section-7.3">
        <h3 id="name-recovery-code-grant">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-recovery-code-grant" class="section-name selfRef">Recovery Code Grant</a>
        </h3>
<p id="section-7.3-1">The client makes a request to the token endpoint by adding the
following parameters using the "application/x-www-form-urlencoded"
format with a character encoding of UTF-8 in the HTTP request body:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3-2">
<pre>
grant_type
  REQUIRED.  `urn:ietf:params:oauth:grant-type:mfa-recovery-code`

recovery_code
  REQUIRED.  The recovery code.

mfa_token
  REQUIRED.  The MFA token, "mfa_token" from the prior authorization
  challenge error response, defined in {{mfa-token-response}}.

client_id
  REQUIRED, if the client is not authenticating with the
  authorization server as described in Section 3.2.1 of OAuth 2.0
  {{RFC6749}}.
</pre><a href="#section-7.3-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3-3">If the client type is confidential or the client was issued client
credentials (or assigned other authentication requirements), the
client <span class="bcp14">MUST</span> authenticate with the authorization server as described
in Section 3.2.1 of OAuth 2.0 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">For example, the client makes the following HTTP request using
transport-layer security (with extra line breaks for display purposes
only):<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3-5">
<pre>
POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:mfa-recovery-code
&amp;recovery_code=WDJB-MJHT&amp;mfa_token=uY29tL2F1dGhlbnRpY
</pre><a href="#section-7.3-5" class="pilcrow">¶</a>
</div>
<p id="section-7.3-6">The authorization server <span class="bcp14">MUST</span>:<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-7.1">require client authentication for confidential clients or for any
client that was issued client credentials (or with other
authentication requirements),<a href="#section-7.3-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-7.2">authenticate the client if client authentication is included,<a href="#section-7.3-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-7.3">ensure that the MFA token was issued to the authenticated
confidential client, or if the client is public, ensure that the
token was issued to "client_id" in the request,<a href="#section-7.3-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-7.4">verify that the MFA token is valid,<a href="#section-7.3-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-7.5">restore the authorization session based on the state referenced by
or encoded into the MFA token, and<a href="#section-7.3-7.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-7.6">validate the recovery code using its existing recovery code
validation algorithm.<a href="#section-7.3-7.6" class="pilcrow">¶</a>
</li>
        </ul>
<div id="access-token-response">
<section id="section-7.3.1">
          <h4 id="name-access-token-response">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-access-token-response" class="section-name selfRef">Access Token Response</a>
          </h4>
<p id="section-7.3.1-1">In addition to the parameters defined in Section 5.1 of OAuth 2.0
<span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>, the following additional parameters are specified for the
recovery code grant:<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.1-2">
<pre>
recovery_code
  OPTIONAL.  A newly issued recovery code, in which case the client
  MUST discard the old recovery code and replace it with the new
  recovery code.
</pre><a href="#section-7.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-7.3.1-3">TODO: Do most systems currently give the user new recovery codes during this flow?<a href="#section-7.3.1-3" class="pilcrow">¶</a></p>
<p id="section-7.3.1-4"></p>
<p id="section-7.3.1-5">Old stuff below<a href="#section-7.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-8">
      <h2 id="name-examples">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="client-receives-trigger-for-authentication">
<section id="section-8.1">
        <h3 id="name-client-receives-trigger-for">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-client-receives-trigger-for" class="section-name selfRef">Client receives trigger for authentication</a>
        </h3>
<p id="section-8.1-1">TODO: The client may receive a trigger from the resource server to initiate an authentication, possibly with a hint from the resource server in the form of an acr value, indicating it needs to initiate and authentications.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">TBD: May need to reference the existing step-up authentication draft instead<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-collects-user-identifier">
<section id="section-8.2">
        <h3 id="name-client-collects-user-identi">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-client-collects-user-identi" class="section-name selfRef">Client collects user identifier</a>
        </h3>
<p id="section-8.2-1">TODO: User identifier can be an email, phone number, or username, at the discretion of the AS.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-initiates-direct-interaction-request">
<section id="section-8.3">
        <h3 id="name-client-initiates-direct-int">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-client-initiates-direct-int" class="section-name selfRef">Client initiates direct interaction request</a>
        </h3>
<p id="section-8.3-1">The client makes a request to the interaction request endpoint providing the client ID and user identifer hint in the request.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-2">
<pre>
POST /interaction
Host: authorization-server.com
Content-type: application/x-www-form-urlencoded

&amp;client_id=XXXXXXX
&amp;username=user@example.com
&amp;scope=contacts+openid+profile
</pre><a href="#section-8.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-server-returns-challenge-types">
<section id="section-8.4">
        <h3 id="name-authorization-server-return">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-authorization-server-return" class="section-name selfRef">Authorization Server returns challenge types</a>
        </h3>
<p id="section-8.4-1">The AS returns an interaction code, as well as a list of challenge types supported.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4-2">
<pre>
HTTP/1.1 403 Forbidden
Content-type: application/json

{
  "error": "...?",
  "interaction_code": "b135ac938e3e84",
  "challenge_type": [
    "password+totp", "email_otp", "redirect"
  ]
}
</pre><a href="#section-8.4-2" class="pilcrow">¶</a>
</div>
<div id="one-time-code">
<section id="section-8.4.1">
          <h4 id="name-one-time-code">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-one-time-code" class="section-name selfRef">One-Time code</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.4.1-1.1">
              <code>email_otp</code><a href="#section-8.4.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.1-1.2">
              <code>sms_otp</code><a href="#section-8.4.1-1.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.1-2">One-time codes sent via email or SMS<a href="#section-8.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="totp">
<section id="section-8.4.2">
          <h4 id="name-totp">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-totp" class="section-name selfRef">TOTP</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.4.2-1.1">
              <code>totp</code><a href="#section-8.4.2-1.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.2-2">TOTP codes generated by an authenticator app<a href="#section-8.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="password">
<section id="section-8.4.3">
          <h4 id="name-password">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-password" class="section-name selfRef">Password</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.4.3-1.1">
              <code>password</code><a href="#section-8.4.3-1.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.3-2">Legacy password authentication<a href="#section-8.4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="push-notification">
<section id="section-8.4.4">
          <h4 id="name-push-notification">
<a href="#section-8.4.4" class="section-number selfRef">8.4.4. </a><a href="#name-push-notification" class="section-name selfRef">Push notification</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.4.4-1.1">
              <code>push_notification</code><a href="#section-8.4.4-1.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.4-2">A push notification delivered to a native application<a href="#section-8.4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect">
<section id="section-8.4.5">
          <h4 id="name-redirect">
<a href="#section-8.4.5" class="section-number selfRef">8.4.5. </a><a href="#name-redirect" class="section-name selfRef">Redirect</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-8.4.5-1.1">
              <code>redirect</code><a href="#section-8.4.5-1.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.4.5-2">In the case where the authorization server wishes to interact with the user itself, limiting the client's interaction with the user, it can return the <code>redirect</code> challenge type. In this case, no <code>interaction_code</code> is returned. Instead, the client is expected to initiate a traditional OAuth Authorization Code flow with PKCE according to <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>.<a href="#section-8.4.5-2" class="pilcrow">¶</a></p>
<p id="section-8.4.5-3">TODO: Instead of no interaction code, should this require the client include the interaction code in the authorization request so the AS can link it to an app-initiated session? Alternatively, if we make the first request require a PKCE code challenge, we could require the same PKCE code challenge be used in the authorization request. My preference here is to include the PKCE code verifier at the start of the protocol. PKCE is well understood and re-using the interaction code to establish the link feels like we are overloading the interaction code. Another option may be to add a session identifier (or return a session identifier as a unique parameter) for the redirect case.<a href="#section-8.4.5-3" class="pilcrow">¶</a></p>
<p id="section-8.4.5-4">This can be used to:<a href="#section-8.4.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4.5-5.1">offer the client a fallback mechanism at the client's perogative (by returning the <code>redirect</code> type as the last item in the <code>challenge_type</code> list)<a href="#section-8.4.5-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-5.2">force the client to use a browser-redirect-based flow (by returning only the <code>redirect</code> type)<a href="#section-8.4.5-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-8.4.5-5.3">enable authentication with social providers or third party IdPs which require a browser flow<a href="#section-8.4.5-5.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="combinations">
<section id="section-8.4.6">
          <h4 id="name-combinations">
<a href="#section-8.4.6" class="section-number selfRef">8.4.6. </a><a href="#name-combinations" class="section-name selfRef">Combinations</a>
          </h4>
<p id="section-8.4.6-1">The AS <span class="bcp14">MAY</span> combine challenge types by concatenating strings with a <code>+</code>, which indicates that all the combined types are required to complete the challenge.<a href="#section-8.4.6-1" class="pilcrow">¶</a></p>
<p id="section-8.4.6-2">TODO: Does the absense of a '+' imply an OR?<a href="#section-8.4.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defining-additional-methods">
<section id="section-8.4.7">
          <h4 id="name-defining-additional-methods">
<a href="#section-8.4.7" class="section-number selfRef">8.4.7. </a><a href="#name-defining-additional-methods" class="section-name selfRef">Defining additional methods</a>
          </h4>
<p id="section-8.4.7-1">Extensibility...<a href="#section-8.4.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-requests-an-authentication-challenge">
<section id="section-8.5">
        <h3 id="name-client-requests-an-authenti">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-client-requests-an-authenti" class="section-name selfRef">Client requests an authentication challenge</a>
        </h3>
<p id="section-8.5-1">Optional.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">For methods that require the AS to deliver a code to the user, e.g. via email or SMS, the client
needs to signal to the AS that it should deliver this code. (Without this step, the AS may not know
which of the available options the client will be communicating to the user, and may not want to send
a code via both email and SMS.). It <span class="bcp14">SHOULD</span> only allow one delivery mechanism at a time to minimise the risk of the challenge leaking.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5-3">
<pre>
POST /challenge
Host: authorization-server.com
Content-type: application/x-www-form-urlencoded

challenge_type=email_otp
&amp;interaction_code=b135ac938e3e84
</pre><a href="#section-8.5-3" class="pilcrow">¶</a>
</div>
<p id="section-8.5-4">The authorization server sends a challenge code to the user via the selected platform.<a href="#section-8.5-4" class="pilcrow">¶</a></p>
<p id="section-8.5-5">The authorization server responds with an authentication challenge code and other information such as timeouts.<a href="#section-8.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5-6">
<pre>
HTTP/1.1 200 OK
Content-type: application/json

{
  "challenge_type": "email_otp",
  "challenge_code": "a6f4463ad1d8e3f",
  "expires_in": 600,
  "interval": 5
}
</pre><a href="#section-8.5-6" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-8.5-7.1">
            <code>challenge_type</code> -<a href="#section-8.5-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-7.2">
            <code>challenge_code</code> -<a href="#section-8.5-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-7.3">
            <code>expires_in</code> - Optional<a href="#section-8.5-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.5-7.4">
            <code>interval</code> - Optional<a href="#section-8.5-7.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="client-provides-authentication-details">
<section id="section-8.6">
        <h3 id="name-client-provides-authenticat">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-client-provides-authenticat" class="section-name selfRef">Client provides authentication details</a>
        </h3>
<p id="section-8.6-1">The client prompts the user to enter the challenge.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.6-2.1">One-time code<a href="#section-8.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.6-2.2">Password<a href="#section-8.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.6-2.3">Out-of-band interaction<a href="#section-8.6-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.6-3">Some methods such as acknowledging a push notification may not require the user to interact further with the client. The client instead presents a screen to the user explaining that they should acknowledge the challenge on another device.<a href="#section-8.6-3" class="pilcrow">¶</a></p>
<p id="section-8.6-4">TODO: How does the Authorisation Server signal to the client that the push notification succeeded on another device?<a href="#section-8.6-4" class="pilcrow">¶</a></p>
<div id="token-request">
<section id="section-8.6.1">
          <h4 id="name-token-request">
<a href="#section-8.6.1" class="section-number selfRef">8.6.1. </a><a href="#name-token-request" class="section-name selfRef">Token request</a>
          </h4>
<p id="section-8.6.1-1">The client makes a request to the token endpoint with the <code>grant_type</code> value of <code>urn:ietf:params:oauth:grant-type:direct</code>, providing the information collected from the user as well as the previous interaction code and optional challenge code.<a href="#section-8.6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.6.1-2">
<pre>
POST /token

Host: authorization-server.com
Content-type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:direct
&amp;client_id=XXXXXXX
&amp;interaction_code=b135ac938e3e84
&amp;challenge_code=a6f4463ad1d8e3f
&amp;challenge_value=512512
</pre><a href="#section-8.6.1-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-8.6.1-3.1">
              <code>challenge_value</code> - The value that was sent to the user. Should this be different depending on the challenge type?<a href="#section-8.6.1-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-8.6.1-4">TODO: What happens if more than one code is requested? Maybe make it so only one can be collected at a time? It would be weird to ask the user to enter two codes at the same time anyway. Not sure we should have a unique interaction code per token. Should the interaction code cover all the interactions (i.e. all interactions are bundled up as one interaction). Once all interactions are complete all tokens for which that interaction is good can be released?<a href="#section-8.6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="checking-for-additional-requirements">
<section id="section-8.7">
        <h3 id="name-checking-for-additional-req">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-checking-for-additional-req" class="section-name selfRef">Checking for additional requirements</a>
        </h3>
<p id="section-8.7-1">If the initial set of information provided by the client is correct, the AS
<span class="bcp14">MAY</span> choose to either respond immediately with a successful token response,
or prompt the client for an additional challenge.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<p id="section-8.7-2">For example, the AS could first require the client prompt the user for a one-time-code they
received via email, and then in a second step, ask the client to prompt the user<a href="#section-8.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="refresh-token-grant">
<section id="section-9">
      <h2 id="name-refresh-token-grant">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-refresh-token-grant" class="section-name selfRef">Refresh Token Grant</a>
      </h2>
<p id="section-9-1">TODO: Describe how the AS could return a challenge to the client on the normal refresh token request
that tells the client they need to get the user to re-authenticate or provide an MFA token.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">TODO Security<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="phishing">
<section id="section-10.1">
        <h3 id="name-phishing">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-phishing" class="section-name selfRef">Phishing</a>
        </h3>
<p id="section-10.1-1">TODO: Describe the phishing risk this opens up.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="native-client-and-authorisation-server-trust-relationship">
<section id="section-10.2">
        <h3 id="name-native-client-and-authorisa">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-native-client-and-authorisa" class="section-name selfRef">Native client and Authorisation Server trust relationship</a>
        </h3>
<p id="section-10.2-1">TODO: Emphasise the 'same owner' relationship between the native client and the authorisation server<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-authentication">
<section id="section-10.3">
        <h3 id="name-client-authentication">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-client-authentication" class="section-name selfRef">Client Authentication</a>
        </h3>
<p id="section-10.3-1">TODO: Describe the lack of client authentication possible because this is expected to be deployed by native apps. Maybe mention alternatives to client authentication such as App Attestation, or using a risk engine to analyze other aspects of the request from the client.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="leaking-information">
<section id="section-10.4">
        <h3 id="name-leaking-information">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-leaking-information" class="section-name selfRef">Leaking Information</a>
        </h3>
<p id="section-10.4-1">TODO: Attackers may be able to query the AS with user IDs to learn whether an identifier corresponds to an active account and which types of authentication a particular account has configured. What mitigations needed here? Possibly avoiding returning an error for unrecognized identifiers.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notification-fatigue">
<section id="section-10.5">
        <h3 id="name-notification-fatigue">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-notification-fatigue" class="section-name selfRef">Notification fatigue</a>
        </h3>
<p id="section-10.5-1">TODO: A client may be able to cause repeated notifications to any user given their user ID.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<p id="section-10.5-2">Mitigations:<a href="#section-10.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.5-3.1">rate limiting<a href="#section-10.5-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-3.2">use notification-based methods only as a secondary factor<a href="#section-10.5-3.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="oauth-parameter-registration">
<section id="section-11.1">
        <h3 id="name-oauth-parameter-registratio">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-oauth-parameter-registratio" class="section-name selfRef">OAuth Parameter Registration</a>
        </h3>
<p id="section-11.1-1">TODO<a href="#section-11.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth-uri-registration">
<section id="section-11.2">
        <h3 id="name-oauth-uri-registration">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-oauth-uri-registration" class="section-name selfRef">OAuth URI Registration</a>
        </h3>
<p id="section-11.2-1">This specification registers the following values in the IANA "OAuth URI"
registry (IANA.OAuth.Parameters) established by <span>[<a href="#RFC6755" class="cite xref">RFC6755</a>]</span>.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2-2">
<pre>
URN: `urn:ietf:params:oauth:grant-type:direct`
Common Name: Direct Interaction Grant Type for OAuth 2.0
Change Controller: IESG
Specification Document:
</pre><a href="#section-11.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="oauth-extensions-error-registration">
<section id="section-11.3">
        <h3 id="name-oauth-extensions-error-regi">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-oauth-extensions-error-regi" class="section-name selfRef">OAuth Extensions Error Registration</a>
        </h3>
<p id="section-11.3-1">This specification registers the following values in the IANA "OAuth
Extensions Error Registry" registry (IANA.OAuth.Parameters)
established by <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.3-2">
<pre>
Name: ...
</pre><a href="#section-11.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-server-metadata">
<section id="section-11.4">
        <h3 id="name-authorization-server-metada">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-authorization-server-metada" class="section-name selfRef">Authorization Server Metadata</a>
        </h3>
<p id="section-11.4-1">This specification defines two new endpoints at the authorization server.
TODO: Need to register these in the Authorization Server Metadata document too.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.4-2.1">interaction endpoint<a href="#section-11.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.4-2.2">challenge endpoint<a href="#section-11.4-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6755">[RFC6755]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"An IETF URN Sub-Namespace for OAuth"</span>, <span class="seriesInfo">RFC 6755</span>, <span class="seriesInfo">DOI 10.17487/RFC6755</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6755">https://www.rfc-editor.org/rfc/rfc6755</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
      <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8628">[RFC8628]</dt>
      <dd>
<span class="refAuthor">Denniss, W.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time datetime="2019-08" class="refDate">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8628">https://www.rfc-editor.org/rfc/rfc8628</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aaron Parecki</span></div>
<div dir="auto" class="left"><span class="org">Okta</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aaron@parecki.com" class="email">aaron@parecki.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pieter Kasselman</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pieter.kasselman@microsoft.com" class="email">pieter.kasselman@microsoft.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
