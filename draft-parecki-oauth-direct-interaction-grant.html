<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 Direct Interaction Grant</title>
<meta content="Aaron Parecki" name="author">
<meta content="Pieter Kasselman" name="author">
<meta content='
       This document extends the OAuth 2.0 Authorization Framework   with a
new grant type, the "Direct Interaction Grant", which can be used by applications
that want to control the user experience of the process of obtaining authorization
from the user. 
       In many cases, this can provide an entirely browserless experience suited for native
applications, delegating to the browser in unexpected or error conditions. 
       While a fully-delegated approach using the Authorization Code Grant is generally
preferred, this draft provides a mechanism for the client to directly interact
with the user. This requires a high degree of trust between the authorization server
and the client. It  SHOULD  only be considered when there are usability
concerns with a browser-based approach, such as for native mobile or desktop applications. 
    ' name="description">
<meta content="xml2rfc 3.15.3" name="generator">
<meta content="oauth" name="keyword">
<meta content="draft-parecki-oauth-direct-interaction-grant-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.15.3
    Python 3.10.8
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.1
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.5
-->
<link href="draft-parecki-oauth-direct-interaction-grant.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl > dt {
  float: left;
  margin-right: 1em;
  min-width: 12ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
dl .break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OAuth 2.0 Direct Interaction Grant</td>
<td class="right">December 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Parecki &amp; Kasselman</td>
<td class="center">Expires 12 June 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">OAuth Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-parecki-oauth-direct-interaction-grant-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-12-09" class="published">9 December 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-06-12">12 June 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Parecki</div>
<div class="org">Okta</div>
</div>
<div class="author">
      <div class="author-name">P. Kasselman</div>
<div class="org">Microsoft</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 Direct Interaction Grant</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document extends the OAuth 2.0 Authorization Framework <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> with a
new grant type, the "Direct Interaction Grant", which can be used by applications
that want to control the user experience of the process of obtaining authorization
from the user.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">In many cases, this can provide an entirely browserless experience suited for native
applications, delegating to the browser in unexpected or error conditions.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">While a fully-delegated approach using the Authorization Code Grant is generally
preferred, this draft provides a mechanism for the client to directly interact
with the user. This requires a high degree of trust between the authorization server
and the client. It <span class="bcp14">SHOULD</span> only be considered when there are usability
concerns with a browser-based approach, such as for native mobile or desktop applications.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://aaronpk.github.io/oauth-direct-interaction-grant/draft-parecki-oauth-direct-interaction-grant.html">https://aaronpk.github.io/oauth-direct-interaction-grant/draft-parecki-oauth-direct-interaction-grant.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-parecki-oauth-direct-interaction-grant/">https://datatracker.ietf.org/doc/draft-parecki-oauth-direct-interaction-grant/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        OAuth Working Group mailing list (<span><a href="mailto:oauth@ietf.org">mailto:oauth@ietf.org</a></span>),
        which is archived at <span><a href="https://oauth.net">https://oauth.net</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/oauth/">https://www.ietf.org/mailman/listinfo/oauth/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/aaronpk/oauth-direct-interaction-grant">https://github.com/aaronpk/oauth-direct-interaction-grant</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 12 June 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-usage-and-applicability" class="internal xref">Usage and Applicability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.1">
                    <p id="section-toc.1-1.1.2.2.2.1.1" class="keepWithNext"><a href="#section-1.2.1" class="auto internal xref">1.2.1</a>.  <a href="#name-sign-up-with-verification" class="internal xref">Sign-up with verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.2">
                    <p id="section-toc.1-1.1.2.2.2.2.1" class="keepWithNext"><a href="#section-1.2.2" class="auto internal xref">1.2.2</a>.  <a href="#name-register-new-authentication" class="internal xref">Register new authentication methods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.3">
                    <p id="section-toc.1-1.1.2.2.2.3.1"><a href="#section-1.2.3" class="auto internal xref">1.2.3</a>.  <a href="#name-sign-in-with-first-factor" class="internal xref">Sign-in with first factor</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.4">
                    <p id="section-toc.1-1.1.2.2.2.4.1"><a href="#section-1.2.4" class="auto internal xref">1.2.4</a>.  <a href="#name-sign-in-with-additional-fac" class="internal xref">Sign-in with additional factor</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.5">
                    <p id="section-toc.1-1.1.2.2.2.5.1"><a href="#section-1.2.5" class="auto internal xref">1.2.5</a>.  <a href="#name-discover-supported-authenti" class="internal xref">Discover supported authentication methods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.6">
                    <p id="section-toc.1-1.1.2.2.2.6.1"><a href="#section-1.2.6" class="auto internal xref">1.2.6</a>.  <a href="#name-discover-supported-account-" class="internal xref">Discover supported account recover authentication methods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.7">
                    <p id="section-toc.1-1.1.2.2.2.7.1"><a href="#section-1.2.7" class="auto internal xref">1.2.7</a>.  <a href="#name-discover-supported-account-r" class="internal xref">Discover supported account recover authentication methods</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.8">
                    <p id="section-toc.1-1.1.2.2.2.8.1"><a href="#section-1.2.8" class="auto internal xref">1.2.8</a>.  <a href="#name-update-an-existing-authenti" class="internal xref">Update an existing authentication method</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.9">
                    <p id="section-toc.1-1.1.2.2.2.9.1"><a href="#section-1.2.9" class="auto internal xref">1.2.9</a>.  <a href="#name-initiate-browser-based-inte" class="internal xref">Initiate browser-based interaction for certain scenarios</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.10">
                    <p id="section-toc.1-1.1.2.2.2.10.1"><a href="#section-1.2.10" class="auto internal xref">1.2.10</a>. <a href="#name-discovering-custom-user-att" class="internal xref">Discovering custom user attributes</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-protocol" class="internal xref">Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-client-receives-trigger-for" class="internal xref">Client receives trigger for authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-client-collects-user-identi" class="internal xref">Client collects user identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-client-initiates-direct-int" class="internal xref">Client initiates direct interaction request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-authorization-server-return" class="internal xref">Authorization Server returns challenge types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-one-time-code" class="internal xref">One-Time code</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-totp" class="internal xref">TOTP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-password" class="internal xref">Password</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.4">
                    <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="auto internal xref">4.4.4</a>.  <a href="#name-push-notification" class="internal xref">Push notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.5">
                    <p id="section-toc.1-1.4.2.4.2.5.1"><a href="#section-4.4.5" class="auto internal xref">4.4.5</a>.  <a href="#name-redirect" class="internal xref">Redirect</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.6">
                    <p id="section-toc.1-1.4.2.4.2.6.1"><a href="#section-4.4.6" class="auto internal xref">4.4.6</a>.  <a href="#name-combinations" class="internal xref">Combinations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.7">
                    <p id="section-toc.1-1.4.2.4.2.7.1"><a href="#section-4.4.7" class="auto internal xref">4.4.7</a>.  <a href="#name-defining-additional-methods" class="internal xref">Defining additional methods</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-client-requests-an-authenti" class="internal xref">Client requests an authentication challenge</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-client-provides-authenticat" class="internal xref">Client provides authentication details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a href="#section-4.6.1" class="auto internal xref">4.6.1</a>.  <a href="#name-token-request" class="internal xref">Token request</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-checking-for-additional-req" class="internal xref">Checking for additional requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-refresh-token-grant" class="internal xref">Refresh Token Grant</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-phishing" class="internal xref">Phishing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-native-client-and-authorisa" class="internal xref">Native client and Authorisation Server trust relationship</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-client-authentication" class="internal xref">Client Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-leaking-information" class="internal xref">Leaking Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-notification-fatigue" class="internal xref">Notification fatigue</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-oauth-parameter-registratio" class="internal xref">OAuth Parameter Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-oauth-uri-registration" class="internal xref">OAuth URI Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-oauth-extensions-error-regi" class="internal xref">OAuth Extensions Error Registration</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-authorization-server-metada" class="internal xref">Authorization Server Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">TODO: Key points to address include problem description, the relationship to the step-up authentication spec (use of acr etc.), properties of the protocol (extensibility etc).<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="usage-and-applicability">
<section id="section-1.1">
        <h3 id="name-usage-and-applicability">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-usage-and-applicability" class="section-name selfRef">Usage and Applicability</a>
        </h3>
<p id="section-1.1-1">TODO: Mention the trust prerequisites for this to be useful. Absolutely not allowed for third-party apps. Designed for native apps, specifically first-party, when the AS and app are operated by the same entity, and the user understands them both as the same entity...<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-cases">
<section id="section-1.2">
        <h3 id="name-use-cases">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
        </h3>
<p id="section-1.2-1">TODO: We may move these to the appendix, but outlining them in the document will also help guide developers to understand what they can (and cannot) expect to be able to to<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<div id="sign-up-with-verification">
<section id="section-1.2.1">
          <h4 id="name-sign-up-with-verification">
<a href="#section-1.2.1" class="section-number selfRef">1.2.1. </a><a href="#name-sign-up-with-verification" class="section-name selfRef">Sign-up with verification</a>
          </h4>
<p id="section-1.2.1-1">e.g. user provides e-mail, is sent a verification code, and then uses the verification code to prove they control the e-mail during sign-up/account creation.<a href="#section-1.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="register-new-authentication-methods">
<section id="section-1.2.2">
          <h4 id="name-register-new-authentication">
<a href="#section-1.2.2" class="section-number selfRef">1.2.2. </a><a href="#name-register-new-authentication" class="section-name selfRef">Register new authentication methods</a>
          </h4>
<p id="section-1.2.2-1">e.g. user selects password, provides phone for SMS codes, etc<a href="#section-1.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sign-in-with-first-factor">
<section id="section-1.2.3">
          <h4 id="name-sign-in-with-first-factor">
<a href="#section-1.2.3" class="section-number selfRef">1.2.3. </a><a href="#name-sign-in-with-first-factor" class="section-name selfRef">Sign-in with first factor</a>
          </h4>
<p id="section-1.2.3-1">e.g. username password<a href="#section-1.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sign-in-with-additional-factor">
<section id="section-1.2.4">
          <h4 id="name-sign-in-with-additional-fac">
<a href="#section-1.2.4" class="section-number selfRef">1.2.4. </a><a href="#name-sign-in-with-additional-fac" class="section-name selfRef">Sign-in with additional factor</a>
          </h4>
<p id="section-1.2.4-1">e.g. user already signed in with one factor (username/password), but now need to "step-up" to second factor (e.g. SMS code).<a href="#section-1.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discover-supported-authentication-methods">
<section id="section-1.2.5">
          <h4 id="name-discover-supported-authenti">
<a href="#section-1.2.5" class="section-number selfRef">1.2.5. </a><a href="#name-discover-supported-authenti" class="section-name selfRef">Discover supported authentication methods</a>
          </h4>
<p id="section-1.2.5-1">e.g. developer can query the authorisation server to determine what authentication methods are supported.<a href="#section-1.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discover-supported-account-recover-authentication-methods">
<section id="section-1.2.6">
          <h4 id="name-discover-supported-account-">
<a href="#section-1.2.6" class="section-number selfRef">1.2.6. </a><a href="#name-discover-supported-account-" class="section-name selfRef">Discover supported account recover authentication methods</a>
          </h4>
<p id="section-1.2.6-1">e.g. developer can query the authorisation server to determine what authentication methods are used for account recovery if one of the methods are lost.<a href="#section-1.2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discover-supported-account-recover-authentication-methods-1">
<section id="section-1.2.7">
          <h4 id="name-discover-supported-account-r">
<a href="#section-1.2.7" class="section-number selfRef">1.2.7. </a><a href="#name-discover-supported-account-r" class="section-name selfRef">Discover supported account recover authentication methods</a>
          </h4>
<p id="section-1.2.7-1">e.g. developer can query the authorisation server to determine what authentication methods are used for account recovery if one of the methods are lost.<a href="#section-1.2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="update-an-existing-authentication-method">
<section id="section-1.2.8">
          <h4 id="name-update-an-existing-authenti">
<a href="#section-1.2.8" class="section-number selfRef">1.2.8. </a><a href="#name-update-an-existing-authenti" class="section-name selfRef">Update an existing authentication method</a>
          </h4>
<p id="section-1.2.8-1">e.g. the authorisation server may require the user to update a password or provide a new phone number, key or alternative e-mail address if it believes the existing mechanism is no longer trustworthy.<a href="#section-1.2.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initiate-browser-based-interaction-for-certain-scenarios">
<section id="section-1.2.9">
          <h4 id="name-initiate-browser-based-inte">
<a href="#section-1.2.9" class="section-number selfRef">1.2.9. </a><a href="#name-initiate-browser-based-inte" class="section-name selfRef">Initiate browser-based interaction for certain scenarios</a>
          </h4>
<p id="section-1.2.9-1">e.g. some scenarios don't benefit from a native implementation and may be more efficiently or securely implemented through the browser (e.g. error scenarios, password recovery, identity verification, social sign-in).<a href="#section-1.2.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discovering-custom-user-attributes">
<section id="section-1.2.10">
          <h4 id="name-discovering-custom-user-att">
<a href="#section-1.2.10" class="section-number selfRef">1.2.10. </a><a href="#name-discovering-custom-user-att" class="section-name selfRef">Discovering custom user attributes</a>
          </h4>
<p id="section-1.2.10-1">e.g. Ability to know mandatory and optional custom attributes configured on the authorisation server (can this be achieve through AS metadata instead of as part of the protocol)?<a href="#section-1.2.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-2.1">
        <h3 id="name-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.1-1">This specification uses the terms "Access Token", "Authorization Code",
"Authorization Endpoint", "Authorization Server" (AS), "Client", "Client Authentication",
"Client Identifier", "Client Secret", "Grant Type", "Protected Resource",
"Redirection URI", "Refresh Token", "Resource Owner", "Resource Server" (RS)
and "Token Endpoint" defined by <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-overview">
<section id="section-3">
      <h2 id="name-protocol-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<ol start="1" type="1" class="normal type-1" id="section-3-1">
<li id="section-3-1.1">The client receives a signal from resource server indicating that a step-up authentication is requried<a href="#section-3-1.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.2">The client prompts the user and collects their user identifier (e.g. email address)<a href="#section-3-1.2" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.3">The client sends the identifier to the AS, along with any hint it may have received about the authentication level required<a href="#section-3-1.3" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.4">The AS replies with the supported authentication mechanisms based on the user ID provided (should these be amr values?)<a href="#section-3-1.4" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.5">The client requests an authentication challenge from the AS (this is optional - only if the authentication method requires it)<a href="#section-3-1.5" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.6">The AS delivers a challenge to the user (e.g. one-time code via email, SMS, or a push notification in an app) (this is optional - only if it is a challenge response type authentiation method).<a href="#section-3-1.6" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.7">The client collects the necessary authentication details from the user and sends them back to the AS<a href="#section-3-1.7" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.8">The AS decides if additional requirements need to be met, repeating steps 3 through 6 as needed (the AS knows this due to the acr_value sent by the client initially)<a href="#section-3-1.8" class="pilcrow">¶</a>
</li>
        <li id="section-3-1.9">The AS replies with the token response<a href="#section-3-1.9" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="protocol">
<section id="section-4">
      <h2 id="name-protocol">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protocol" class="section-name selfRef">Protocol</a>
      </h2>
<div id="client-receives-trigger-for-authentication">
<section id="section-4.1">
        <h3 id="name-client-receives-trigger-for">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-client-receives-trigger-for" class="section-name selfRef">Client receives trigger for authentication</a>
        </h3>
<p id="section-4.1-1">TODO: The client may receive a trigger from the resource server to initiate an authentication, possibly with a hint from the resource provider in the form of an acr value, indicating it needs to initiate and authentications.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">TBD: May need to reference the existing step-up authentication draft instead<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-collects-user-identifier">
<section id="section-4.2">
        <h3 id="name-client-collects-user-identi">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-client-collects-user-identi" class="section-name selfRef">Client collects user identifier</a>
        </h3>
<p id="section-4.2-1">TODO: User identifier can be an email, phone number, or username, at the discretion of the AS.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-initiates-direct-interaction-request">
<section id="section-4.3">
        <h3 id="name-client-initiates-direct-int">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-client-initiates-direct-int" class="section-name selfRef">Client initiates direct interaction request</a>
        </h3>
<p id="section-4.3-1">The client makes a request to the interaction request endpoint providing the client ID and user identifer hint in the request.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
POST /interaction
Host: authorization-server.com
Content-type: application/x-www-form-urlencoded

&amp;client_id=XXXXXXX
&amp;username=user@example.com
&amp;scope=contacts+openid+profile
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-server-returns-challenge-types">
<section id="section-4.4">
        <h3 id="name-authorization-server-return">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-authorization-server-return" class="section-name selfRef">Authorization Server returns challenge types</a>
        </h3>
<p id="section-4.4-1">The AS returns an interaction code, as well as a list of challenge types supported.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-2">
<pre>
HTTP/1.1 403 Forbidden
Content-type: application/json

{
  "error": "...?",
  "interaction_code": "b135ac938e3e84",
  "challenge_type": [
    "password+totp", "email_otp", "redirect"
  ]
}
</pre><a href="#section-4.4-2" class="pilcrow">¶</a>
</div>
<div id="one-time-code">
<section id="section-4.4.1">
          <h4 id="name-one-time-code">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-one-time-code" class="section-name selfRef">One-Time code</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-4.4.1-1.1">
              <code>email_otp</code><a href="#section-4.4.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.1-1.2">
              <code>sms_otp</code><a href="#section-4.4.1-1.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.1-2">One-time codes sent via email or SMS<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="totp">
<section id="section-4.4.2">
          <h4 id="name-totp">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-totp" class="section-name selfRef">TOTP</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-4.4.2-1.1">
              <code>totp</code><a href="#section-4.4.2-1.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.2-2">TOTP codes generated by an authenticator app<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="password">
<section id="section-4.4.3">
          <h4 id="name-password">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-password" class="section-name selfRef">Password</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-4.4.3-1.1">
              <code>password</code><a href="#section-4.4.3-1.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.3-2">Legacy password authentication<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="push-notification">
<section id="section-4.4.4">
          <h4 id="name-push-notification">
<a href="#section-4.4.4" class="section-number selfRef">4.4.4. </a><a href="#name-push-notification" class="section-name selfRef">Push notification</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-4.4.4-1.1">
              <code>push_notification</code><a href="#section-4.4.4-1.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.4-2">A push notification delivered to a native application<a href="#section-4.4.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redirect">
<section id="section-4.4.5">
          <h4 id="name-redirect">
<a href="#section-4.4.5" class="section-number selfRef">4.4.5. </a><a href="#name-redirect" class="section-name selfRef">Redirect</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-4.4.5-1.1">
              <code>redirect</code><a href="#section-4.4.5-1.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.4.5-2">In the case where the authorization server wishes to interact with the user itself, limiting the client's interaction with the user, it can return the <code>redirect</code> challenge type. In this case, no <code>interaction_code</code> is returned. Instead, the client is expected to initiate a traditional OAuth Authorization Code flow with PKCE according to <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and <span>[<a href="#RFC7636" class="cite xref">RFC7636</a>]</span>.<a href="#section-4.4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.4.5-3">TODO: Instead of no interaction code, should this require the client include the interaction code in the authorization request so the AS can link it to an app-initiated session? Alternatively, if we make the first request require a PKCE code challenge, we could require the same PKCE code challenge be used in the authorization request. My preference here is to include the PKCE code verifier at the start of the protocol. PKCE is well understood and re-using the interaction code to establish the link feels like we are overloading the interaction code. Another option may be to add a session identifier (or return a session identifier as a unique parameter) for the redirect case.<a href="#section-4.4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.4.5-4">This can be used to:<a href="#section-4.4.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4.5-5.1">offer the client a fallback mechanism at the client's perogative (by returning the <code>redirect</code> type as the last item in the <code>challenge_type</code> list)<a href="#section-4.4.5-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.5-5.2">force the client to use a browser-redirect-based flow (by returning only the <code>redirect</code> type)<a href="#section-4.4.5-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.4.5-5.3">enable authentication with social providers or third party IdPs which require a browser flow<a href="#section-4.4.5-5.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="combinations">
<section id="section-4.4.6">
          <h4 id="name-combinations">
<a href="#section-4.4.6" class="section-number selfRef">4.4.6. </a><a href="#name-combinations" class="section-name selfRef">Combinations</a>
          </h4>
<p id="section-4.4.6-1">The AS <span class="bcp14">MAY</span> combine challenge types by concatenating strings with a <code>+</code>, which indicates that all the combined types are required to complete the challenge.<a href="#section-4.4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.4.6-2">TODO: Does the absense of a '+' imply an OR?<a href="#section-4.4.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defining-additional-methods">
<section id="section-4.4.7">
          <h4 id="name-defining-additional-methods">
<a href="#section-4.4.7" class="section-number selfRef">4.4.7. </a><a href="#name-defining-additional-methods" class="section-name selfRef">Defining additional methods</a>
          </h4>
<p id="section-4.4.7-1">Extensibility...<a href="#section-4.4.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="client-requests-an-authentication-challenge">
<section id="section-4.5">
        <h3 id="name-client-requests-an-authenti">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-client-requests-an-authenti" class="section-name selfRef">Client requests an authentication challenge</a>
        </h3>
<p id="section-4.5-1">Optional.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">For methods that require the AS to deliver a code to the user, e.g. via email or SMS, the client
needs to signal to the AS that it should deliver this code. (Without this step, the AS may not know
which of the available options the client will be communicating to the user, and may not want to send
a code via both email and SMS.). It <span class="bcp14">SHOULD</span> only allow one delivery mechanism at a time to minimise the risk of the challenge leaking.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-3">
<pre>
POST /challenge
Host: authorization-server.com
Content-type: application/x-www-form-urlencoded

challenge_type=email_otp
&amp;interaction_code=b135ac938e3e84
</pre><a href="#section-4.5-3" class="pilcrow">¶</a>
</div>
<p id="section-4.5-4">The authorization server sends a challenge code to the user via the selected platform.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">The authorization server responds with an authentication challenge code and other information such as timeouts.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.5-6">
<pre>
HTTP/1.1 200 OK
Content-type: application/json

{
  "challenge_type": "email_otp",
  "challenge_code": "a6f4463ad1d8e3f",
  "expires_in": 600,
  "interval": 5
}
</pre><a href="#section-4.5-6" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-4.5-7.1">
            <code>challenge_type</code> -<a href="#section-4.5-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-7.2">
            <code>challenge_code</code> -<a href="#section-4.5-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-7.3">
            <code>expires_in</code> - Optional<a href="#section-4.5-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-7.4">
            <code>interval</code> - Optional<a href="#section-4.5-7.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="client-provides-authentication-details">
<section id="section-4.6">
        <h3 id="name-client-provides-authenticat">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-client-provides-authenticat" class="section-name selfRef">Client provides authentication details</a>
        </h3>
<p id="section-4.6-1">The client prompts the user to enter the challenge.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.6-2.1">One-time code<a href="#section-4.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.6-2.2">Password<a href="#section-4.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.6-2.3">Out-of-band interaction<a href="#section-4.6-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.6-3">Some methods such as acknowledging a push notification may not require the user to interact further with the client. The client instead presents a screen to the user explaining that they should acknowledge the challenge on another device.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">TODO: How does the Authorisation Server signal to the client that the push notification succeeded on another device?<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<div id="token-request">
<section id="section-4.6.1">
          <h4 id="name-token-request">
<a href="#section-4.6.1" class="section-number selfRef">4.6.1. </a><a href="#name-token-request" class="section-name selfRef">Token request</a>
          </h4>
<p id="section-4.6.1-1">The client makes a request to the token endpoint with the <code>grant_type</code> value of <code>urn:ietf:params:oauth:grant-type:direct</code>, providing the information collected from the user as well as the previous interaction code and optional challenge code.<a href="#section-4.6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.6.1-2">
<pre>
POST /token

Host: authorization-server.com
Content-type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:direct
&amp;client_id=XXXXXXX
&amp;interaction_code=b135ac938e3e84
&amp;challenge_code=a6f4463ad1d8e3f
&amp;challenge_value=512512
</pre><a href="#section-4.6.1-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-4.6.1-3.1">
              <code>challenge_value</code> - The value that was sent to the user. Should this be different depending on the challenge type?<a href="#section-4.6.1-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.6.1-4">TODO: What happens if more than one code is requested? Maybe make it so only one can be collected at a time? It would be weird to ask the user to enter two codes at the same time anyway. Not sure we should have a unique interaction code per token. Should the interaction code cover all the interactions (i.e. all interactions are bundled up as one interaction). Once all interactions are complete all tokens for which that interaction is good can be released?<a href="#section-4.6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="checking-for-additional-requirements">
<section id="section-4.7">
        <h3 id="name-checking-for-additional-req">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-checking-for-additional-req" class="section-name selfRef">Checking for additional requirements</a>
        </h3>
<p id="section-4.7-1">If the initial set of information provided by the client is correct, the AS
<span class="bcp14">MAY</span> choose to either respond immetiately with a successful token request (response?),
or prompt the client with an additional challenge.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">For example, the AS could first require the client prompt the user for a one-time-code they
received via email, and then in a second step, ask the client to prompt the user<a href="#section-4.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="refresh-token-grant">
<section id="section-5">
      <h2 id="name-refresh-token-grant">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-refresh-token-grant" class="section-name selfRef">Refresh Token Grant</a>
      </h2>
<p id="section-5-1">TODO: Describe how the AS could return a challenge to the client on the normal refresh token request
that tells the client they need to get the user to re-authenticate or provide an MFA token.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">TODO Security<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="phishing">
<section id="section-6.1">
        <h3 id="name-phishing">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-phishing" class="section-name selfRef">Phishing</a>
        </h3>
<p id="section-6.1-1">TODO: Describe the phishing risk this opens up.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="native-client-and-authorisation-server-trust-relationship">
<section id="section-6.2">
        <h3 id="name-native-client-and-authorisa">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-native-client-and-authorisa" class="section-name selfRef">Native client and Authorisation Server trust relationship</a>
        </h3>
<p id="section-6.2-1">TODO: Emphasise the 'same owner' relationship between the native client and the authorisation server<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-authentication">
<section id="section-6.3">
        <h3 id="name-client-authentication">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-client-authentication" class="section-name selfRef">Client Authentication</a>
        </h3>
<p id="section-6.3-1">TODO: Describe the lack of client authentication possible because this is expected to be deployed by native apps. Maybe mention alternatives to client authentication such as App Attestation, or using a risk engine to analyze other aspects of the request from the client.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="leaking-information">
<section id="section-6.4">
        <h3 id="name-leaking-information">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-leaking-information" class="section-name selfRef">Leaking Information</a>
        </h3>
<p id="section-6.4-1">TODO: Attackers may be able to query the AS with user IDs to learn whether an identifier corresponds to an active account and which types of authentication a particular account has configured. What mitigations needed here? Possibly avoiding returning an error for unrecognized identifiers.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notification-fatigue">
<section id="section-6.5">
        <h3 id="name-notification-fatigue">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-notification-fatigue" class="section-name selfRef">Notification fatigue</a>
        </h3>
<p id="section-6.5-1">TODO: A client may be able to cause repeated notifications to any user given their user ID. Mitigations - throttling<a href="#section-6.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="oauth-parameter-registration">
<section id="section-7.1">
        <h3 id="name-oauth-parameter-registratio">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-oauth-parameter-registratio" class="section-name selfRef">OAuth Parameter Registration</a>
        </h3>
<p id="section-7.1-1">TODO<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="oauth-uri-registration">
<section id="section-7.2">
        <h3 id="name-oauth-uri-registration">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-oauth-uri-registration" class="section-name selfRef">OAuth URI Registration</a>
        </h3>
<p id="section-7.2-1">This specification registers the following values in the IANA "OAuth URI"
registry (IANA.OAuth.Parameters) established by <span>[<a href="#RFC6755" class="cite xref">RFC6755</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-2">
<pre>
URN: `urn:ietf:params:oauth:grant-type:direct`
Common Name: Direct Interaction Grant Type for OAuth 2.0
Change Controller: IESG
Specification Document:
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="oauth-extensions-error-registration">
<section id="section-7.3">
        <h3 id="name-oauth-extensions-error-regi">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-oauth-extensions-error-regi" class="section-name selfRef">OAuth Extensions Error Registration</a>
        </h3>
<p id="section-7.3-1">This specification registers the following values in the IANA "OAuth
Extensions Error Registry" registry (IANA.OAuth.Parameters)
established by <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3-2">
<pre>
Name: ...
</pre><a href="#section-7.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authorization-server-metadata">
<section id="section-7.4">
        <h3 id="name-authorization-server-metada">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-authorization-server-metada" class="section-name selfRef">Authorization Server Metadata</a>
        </h3>
<p id="section-7.4-1">This specification defines two new endpoints at the authorization server.
TODO: Need to register these in the Authorization Server Metadata document too.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-2.1">interaction endpoint<a href="#section-7.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.4-2.2">challenge endpoint<a href="#section-7.4-2.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-normative-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
      <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6749">https://www.rfc-editor.org/rfc/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6755">[RFC6755]</dt>
      <dd>
<span class="refAuthor">Campbell, B.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"An IETF URN Sub-Namespace for OAuth"</span>, <span class="seriesInfo">RFC 6755</span>, <span class="seriesInfo">DOI 10.17487/RFC6755</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6755">https://www.rfc-editor.org/rfc/rfc6755</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
      <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7636">https://www.rfc-editor.org/rfc/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO acknowledge.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aaron Parecki</span></div>
<div dir="auto" class="left"><span class="org">Okta</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aaron@parecki.com" class="email">aaron@parecki.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Pieter Kasselman</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pieter.kasselman@microsoft.com" class="email">pieter.kasselman@microsoft.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
